## Setup AWS

### SSH Keys
You should have a PEM file `ecs-ssh.pem` in your SSH keys. This key can be generated by yourself or created from the
EC2 key pairs page. Note that a key created through AWS may need to be imported to the Terraform state and then
re-applied.

```bash
ssh-add -K ~/.ssh/ecs-ssh.pem
```

### Elastic Container Registry
The AWS-provided instructions for setting up ECR are error-prone.

Add ECR full access permissions to your default profile. This can be done through the IAM page by searching for the
`AmazonEC2ContainerRegistryFullAccess` policy and attaching it to the user group associated with that user.

Add the following line to `~/.docker/config.json` under the credentials helper. Note that the account ID and
availability zone will depend on what's configured for your default profile. An example is provided below.  
`ACCOUNT_ID = 354602850983`  
`REGION = us-east-2`  

```json
{
  ...
  "credHelpers" : {
    ...
    "<ACCOUNT_ID>.dkr.ecr.<REGION>.amazonaws.com": "ecr-login"
  }
  ...
}
```

Install the ECR helper.
```bash
brew install docker-credential-helper-ecr
```

### Global Account Settings
Enable elastic network interface trunking.
```bash
aws ecs put-account-setting-default --profile prod --name awsvpcTrunking --value enabled --region us-east-2
```
